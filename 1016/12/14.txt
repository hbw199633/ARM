进程间通信之信号通信；

kill -9  12345

1、kill 是一个发送端进程，可以独立执行。
2、12345 是pid为该值的进程，可以独立执行。
3、 -9   是kill -l 列出的"信号"编号，进程间通信数据。


1、信号的发送端程序；===》系统命令kill ===》man 2 kill

#include <sys/types.h>
#include <signal.h>

int kill(pid_t pid, int sig);
功能；该函数可以给指定pid的进程发送编号为sig的信号；
	  完成当前进程与目标进程的进程间通信；
参数： pid 目标进程pid号
	   sig  要发送的信号的编号，详见 kill  -l
返回值：成功 0
		失败 -1；


练习：
	使用kill函数编写一个mykill程序，尽量和kill命令功能相似；




特殊的发送函数：
1、  int raise(int sig);
     功能：该函数可以给当前进程自己发送一个特定信号；
	 参数：sig 要发送的信号；
	 返回值：成功 0
	 		 失败 -1；


2、  unsigned int alarm(unsigned int seconds);
     功能：该函数可以为当前进程设置一个闹钟，当闹钟时间
	 	   到达时候，系统会给当前进程发送一个SIGALRM 信号；
	 参数：seconds 闹钟的时间，单位是秒；
	 返回值：成功 设置的秒数	
	 		失败  -1；
     注意：默认进程收到闹钟信号会退出当前程序。
	 
	
思考题：
1、一个进程中如果有多个闹钟信号，那个生效？

2、如果进程处于暂停状态，能否收到闹钟信号？

==============================================================
信号： kill -l

1- 31 不稳定信号，每个信号有具体的系统定义，其中预留给程序员使用
	  的信号是10 SIGUSR1  12 SIGUSR2.

34 - 64 尚未定义，

使用信号通信，目前主要的数据就是 信号 本身。


===============================================================
信号的接收端：

任何进程接收到一个信号后会有如下三种对于信号的处理方式：
1、默认处理，大部分信号收到后进程自动退出；
2、忽略处理，信号到达后不做任何相应，继续运行；
3、自定义处理，根据不同信号编号执行指定函数逻辑；


以上处理方式必须显式的在进程启动过程中设置生效，否则按默认处理；

===》信号注册；===》信号处理函数 signal()

#include <signal.h>

typedef void (*sighandler_t)(int);
  =====> sighandler_t  ==  void (*pfun)(int);
  =====> 函数指针 pfun  ===>指向一个函数  void xxx (int num);
  =====> typedef  ===> pfun  函数类型

sighandler_t  signal(int  signum, sighandler_t handler);

===>等价于 
void ( *signal(int signum, void (*handler)(int)) ) (int);

===>简化为：
    xxx  signal(int sig, xxx fun);
	其中 fun 就是信号的处理函数，同时signal就是信号注册函数；
	fun 可以有如下几种方式：
		fun  == SIG_IGN 宏名称 信号sig会被忽略
		fun  == SIG_DFL 宏名称 信号sig会默认处理
		fun  == void test(int sig) 的函数名称，则信号会被自定义
				交由test函数执行；


练习题：
	编写代码测试信号编号中 1- 31 号信号是否可以全部被忽略，
	有那些信号不能被忽略并记录其编号。

	9  SIGKILL
	19 SIGSTOP
	18 SIGCONT   ===>都不能被忽略；

默认处理：不论是否有信号注册函数都会执行默认流程，则是默认处理流程
		signal(sig,SIG_DFL);


自定义处理： 

1、必须事先按照格式定义信号处理回调函数：
	void fun(int sig)
	{
	
	}
2、在进程中注册信号处理函数为：

   signal(sig,fun);


练习：
1、测试9 19 18 信号是否可以被自定义处理？

2、闹钟信号能不能被自定义之后继续执行进程原有操作？

3、如何在自定义处理函数中结束整个进程？


作业：
使用信号的进程间通信方式完成如下功能要求：

1、进程1 给  进程2  发送数字

2、进程1 给   进程2  发送字符串

3、进程1 给  进程2   发送文件；




